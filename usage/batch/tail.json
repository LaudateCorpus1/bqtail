{
  "BatchURL": "gs://myBucket/batch/",
  "ErrorURL": "gs://myBucket/errors/",
  "JournalURL": "gs://myBucket/journal/",
  "DeferTaskURL": "gs://myBucket/tasks/",
  "Routes": [
    {
      "When": {
        "Prefix": "/data/",
        "Suffix": ".avro"
      },
      "Dest": {
        "Table": "mydataset.mytable"
      },
      "Async": true,
      "Batch": {
        "Window": {
          "DurationInSec": 30
        }
      },
      "OnSuccess": [
        {
          "Action": "delete"
        },
        {
          "Action": "query",
          "Request": {
            "SQL" :"SELECT $jobID AS job_id, COUNT(1) AS cnt, CURRENT_TIMESTAMP() AS completed FROM $dest",
            "Append": true,
            "Dest": "mydataset.ingestion_journal"
          }
        }
      ],
      "OnFailure": [
        {
          "Action": "move",
          "Request": {
            "DestURL": "gs://myBucket/errors"
          }
        }
      ]
    }
  ]
}